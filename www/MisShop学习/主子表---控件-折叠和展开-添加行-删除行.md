主子表，指的是详情和编辑页面中，同时显示主表的记录内容，以及该主表对应的多条子表的记录内容。

例如主表是 *用户*，对应多个客户（通过客户的联系人字段），以及多个部门（通过部门的主管字段）

MisShop中，使用模板生成主子页面只需要几秒钟，哪怕不用模板自动生成，通过 **聪明的控件**，完成一个主子编辑页面仅仅 **几分钟** 而已

***
1.用模板建立主子表
=============

添加页面时选择数据表 用户 使用模板 **列表_主子编辑** ，生成主子编辑列表，点击添加或者删除按钮，看到的主子表效果如下。

>![主子表编辑页面](https://upload-images.jianshu.io/upload_images/12920178-283f93b7a21aeaa7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
>*  基本信息：填写用户表的字段。
>*  部门信息：这是一个数据表格，可以通过添加行，删除行来添加删除这个用户管理的部门，还可以折叠起来。
>*  客户信息：这是一个数据表格，可以通过添加行，删除行来添加删除这个用户管理的客户，还可以折叠起来。
>*  有多少个数据表对用户的多对一引用，就会生成多少个子表。

下面我们看一下如果不用模板，主子编辑页面是如何配手动配置的，我们以部门信息子表为例来说明。

***
2.主子编辑页的子表数据 
=============
增加页面数据 **ds_部门** ，这是一个主管字段的id等于it.id（编辑的用户的id）的部门数据集。
>![部门子表的页面数据](https://upload-images.jianshu.io/upload_images/12920178-87f801840f75613e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

如果有多个子表，那么就建立多个子表页面数据。



3.子表的前置部分的手动配置。 控件水平分隔线，折叠和展开。
=============
子表的前置部分包括水平分割线，标题，折叠展开按钮。
>![部门信息](https://upload-images.jianshu.io/upload_images/12920178-70a8e440c15bd59a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

*  水平分割线：把A7格设置控件为 **水平分割线** ，表现为一条横线。
*  子表标题：  把A8填写单元格值为 “客户信息”，配置静态样式。
*  折叠展开按钮：把H12设置控件为 **折叠和展开**，绿色的配置项表示聪明的平台已经帮您设置好了。

>![折叠和展开控件的配置](https://upload-images.jianshu.io/upload_images/12920178-04e31b543bc117a6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


***

4.子表表格的手动配置。 控件添加行，删除行
=============
**设置表格区域**：选中9，10行的所有格子，鼠标右键，设置为区域，区域控件选择表格。
从左下方的数据中，把 **ds_部门** 拖拽到A9格，或者手动填写列头和列值。
>![子表表格配置](https://upload-images.jianshu.io/upload_images/12920178-12be2e90a17868d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

**设置添加行** 
把G10格的控件类型设为添加行 。绿色的配置信息表示平台已经自动设置好了。
>![添加行配置](https://upload-images.jianshu.io/upload_images/12920178-f290b4334aa51e57.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
点击该按钮会自动在页面上添加从起始格到终止格之间的行。


**设置删除行**
设置H10格的控件类型为删除行。绿色的配置信息表示平台已经自动设置好了。
![删除行配置](https://upload-images.jianshu.io/upload_images/12920178-0919108a228ffb15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



***
5.总结
=============

通过 **聪明的控件**，开发者只需要选择控件类型，而不需要配置繁琐的细节，
剩下的都由平台代劳了，开发起来是轻松加愉快。

***
6.附录：高级用法：折叠和展开/添加行/删除行的手动配置
=============

**折叠和展开配置项**
>开启名称和关闭名称：开启和关闭的时候显示的名称
>起始行：折叠时从哪一行开始折叠，A9#H10表示折叠A9~H10这个区域。
>终止行：折叠时到哪一行为止，可以不配置，不配置表示只折叠一行或者一个区域。

**添加行配置项**

如果不配置默认添加当前行。如果需要添加的行不是当前行（例如添加行按钮放在上面），或者添加的是多行，那么需要手动配置这两个参数。
下面的表格表示添加的行中某一个格子的值会被设置为什么，
例如这里系统自动设置了添加的行的A10格（id格）的值和显示值都是空。

>举个例子，如果需求是新增的客户数据状态为Dict.客户状态.未签约，那么可以在这里增加一行，单元格是客户状态的格子，值是Dict.客户状态.未签约。


**删除行配置项**：
*  表名，字段名，字段值，根据什么值去哪个表，按照什么字段进行删除。
*  起始格，终止格：删除的时候去掉页面哪几行。
*  删除类型：是立即删除数据，还是删除行但不操作数据，还是删除数据缓存到页面里（点击保存按钮的时候一起提交）。聪明的平台会自动进行判断，如果是编辑页面默认是删除缓存到页面，如果是普通页面默认是立即删除数据。




















